<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
            <title>
            </title>
            <link href="/docusign/dataTablesAssets/bootstrap.min.css" rel="stylesheet" type="text/css">
                <link href="/docusign/dataTablesAssets/dataTables.bootstrap.min.css" rel="stylesheet" type="text/css">
                </link>
            </link>
        </meta>
    </head>
    <body>
        <table cellspacing="0" class="display" id="envelopeStatusTable" width="100%">
            <thead>
                <tr>
                    <th>
                        Envelope Id
                    </th>
                    <th>
                        Status
                    </th>
                    <th>
                        Changed Time
                    </th>
                </tr>
            </thead>
            <tfoot>
                <tr>
                    <th>
                        Envelope Id
                    </th>
                    <th>
                        Status
                    </th>
                    <th>
                        Changed Time
                    </th>
                </tr>
            </tfoot>
        </table>
        <script src="/docusign/dataTablesAssets/jquery-1.12.3.js" type="text/javascript">
        </script>
        <script src="/docusign/dataTablesAssets/jquery.dataTables.min.js" type="text/javascript">
        </script>
        <script src="/docusign/dataTablesAssets/dataTables.bootstrap.min.js" type="text/javascript">
        </script>
        <script>
            $(function() {

                var processData = function(serverScrewyData){

                    var expectedData = {
                      "draw": serverScrewyData.draw,
                      "recordsFiltered": serverScrewyData.recordsFiltered,
                      "recordsTotal": serverScrewyData.recordsTotal
                    }

                    // var expectedData = {
                    //   "draw": "2",
                    //   "recordsFiltered": "10",
                    //   "recordsTotal": "100"
                    // }
                    
                    var dataDoOver = [];
                    $.each(serverScrewyData.data.myArrayList, function( index, value ){
                        console.log(JSON.stringify(value));
                        dataDoOver.push(value.map);

                    });
                    expectedData.data = dataDoOver;

                    return expectedData;

                };

            $('#envelopeStatusTable').DataTable({
                "ajax": function (data, callback, settings) {

                    $.post("/docusign-component/control/getEnvelopeStatus", data)
                    .done(function(response){
                        //console.log(JSON.stringify(response));
                        callback(processData(response));
                    });
                    
                },
                "processing": true,
                "serverSide": true,
                "pagingType": "simple",
                "columns": [{
                    "data": "envelopeId"
                }, {
                    "data": "status"
                }, {
                    "data": "statusChangedDateTime"
                }]

            });
        });
        </script>
    </body>
</html>
